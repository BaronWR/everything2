<node>
  <nltext></nltext>
  <parent_container>1898369</parent_container>
  <nlgoto>0</nlgoto>
  <totalvotes>0</totalvotes>
  <createtime>2009-11-13 20:56:23</createtime>
  <lastupdate>1264775823</lastupdate>
  <node_id>1988649</node_id>
  <type_nodetype>9</type_nodetype>
  <nodelet_id>1988649</nodelet_id>
  <nlcode>       [%
my $writeupID = $query-&gt;param('lastcoolwriteup') || 10000000;
my $repthreshholdlo = 18 ;
my $repthreshholdhi = 26;
my $limit = 1;
my $length = 512;

my $csr = $DB-&gt;sqlSelectMany(
'writeup_id, parent_e2node,
(select title from node where node_id=writeup.wrtype_writeuptype limit 1) as type_title,
(select author_user from node where node_id=writeup.writeup_id limit 1) as author_user,
(select doctext from document where document_id=writeup.writeup_id limit 1) as doctext' ,

'writeup LEFT JOIN node ON node_id=writeup_id' ,

&quot;reputation &gt; $repthreshholdlo
	AND reputation &lt; $repthreshholdhi
	AND cooled != 0
AND writeup_id &lt; $writeupID&quot; ,
&quot;ORDER BY writeup_id DESC LIMIT $limit&quot;
) ;


my $str = htmlcode( 'show content' , $csr , 'parenttitle, type, byline,'.$length ) ;

# stop PRE breaking layout: replace PRE with TT; fix spaces and newlines to still work
while ( $str =~ /&lt;pre&gt;(.*?)&lt;\/pre&gt;/si )
	{
	my $temp = $1;
	$temp =~ s/\n/&lt;br&gt;/g;
	$str =~ s/&lt;pre&gt;(.*?)&lt;\/pre&gt;/&lt;tt&gt;$temp&lt;\/tt&gt;/si;
	$str =~ s/  / &amp;nbsp;/g; # replace two spaces with space and nbsp
	}
$str =~ s!&lt;hr.+&gt;!&lt;hr&gt;!ig ; # no width on hr to avoid stretch

$csr-&gt;execute;

my $wu = $csr-&gt;fetchrow_hashref;

&quot;&lt;div id=\&quot;cotc\&quot;&gt;\n$str\n&lt;/div&gt;&quot; . 

'&lt;script&gt;
E2AJAX.updateNodelet.delay(30, &quot;Cream of the Cool Test&quot;, {lastcoolwriteup: '.$$wu{writeup_id}.'});
&lt;/script&gt;';
;
%]



</nlcode>
  <title>Cream of the Cool Test</title>
</node>
