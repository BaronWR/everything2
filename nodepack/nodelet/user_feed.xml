<node>
  <nltext></nltext>
  <parent_container>0</parent_container>
  <nlgoto>0</nlgoto>
  <lastupdate>1258761162</lastupdate>
  <node_id>1988878</node_id>
  <type_nodetype>9</type_nodetype>
  <nlcode>[%

return unless $$NODE{type_nodetype} eq getNode(&quot;user&quot;,&quot;nodetype&quot;)-&gt;{node_id};
my $limit = 10;

use JSON;
my $str;


my ($csr) = $DB-&gt;sqlSelectMany(&quot;node_id, doctext&quot;, &quot;node inner join document on node.node_id =document.document_id&quot;,&quot;node.author_user = $$NODE{user_id} and node.type_nodetype=1988675 order by node_id desc limit 50&quot;);

while (my $feedItem = $csr-&gt;fetchrow_hashref) {

	$str .= &quot;&lt;div class='feeditem' id='feeditem_&quot;.$$feedItem{node_id}.&quot;' style='background-color: #eeeeee; padding: .5em; margin-bottom: .2em; border: solid 1px #000000;'&gt;&lt;div&gt;&quot;.$$feedItem{doctext}.&quot;&lt;/div&gt;
&lt;div&gt;&lt;a href='javascript:E2AJAX.deleteFeedItem(&quot;.$$feedItem{node_id}.&quot;)'&gt;Delete&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;\n&quot;;
}

$str = 
&quot;&lt;div id='feed_list' style='margin-left: 0; padding-left: 0; font-size: 90%;'&gt;&quot;.$str. &quot;&lt;/div&gt;&quot;;

if ($$NODE{user_id} == $$USER{user_id}) {
$str = &quot;
&lt;h4&gt;Add feed item&lt;/h4&gt;
&lt;textarea name='new_feed_item' id='new_feed_item'&gt;&lt;/textarea&gt;
&lt;br /&gt;
&lt;input type='button' onclick='E2AJAX.addFeedItem(\$F(\&quot;new_feed_item\&quot;))' value='Add' /&gt;
&quot; .$str;
}
&quot;&lt;div&gt;&lt;a href='javascript:filterFeed(\&quot;all&quot;\&quot;)'&gt;All&lt;/a&gt; &lt;a href='javascript:filterFeed(\&quot;bookmarks&quot;\&quot;)'&gt;Bookmarks&lt;/a&gt; &lt;a href=javascript:filterFeed(\&quot;cools&quot;\&quot;)''&gt;Cools&lt;/a&gt; (don't work yet)&lt;/a&gt;&quot;.
$str;

%]
</nlcode>
  <title>User Feed</title>
</node>
