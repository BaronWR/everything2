<node>
  <core>0</core>
  <reputation>0</reputation>
  <lockedby_user>0</lockedby_user>
  <createtime>2011-03-08 06:11:21</createtime>
  <locktime>0000-00-00 00:00:00</locktime>
  <totalvotes>0</totalvotes>
  <hits>0</hits>
  <node_id>1991488</node_id>
  <htmlcode_id>1991488</htmlcode_id>
  <checks_arguments>0</checks_arguments>
  <code>my $destination = shift;
$destination = $NODE if !defined $destination;

my %canEnter = {
  &quot;canEnter&quot; =&gt; 0
  , &quot;explanation&quot; =&gt; &quot;&quot;
  , &quot;warning&quot; =&gt; 0
};

if ($$destination{type}{title} ne &quot;room&quot;) {

  $canEnter{explanation} = &quot;That is not a room.&quot;;

} elsif (getId($USER) == $HTMLVARS{guest_user}) {

  $canEnter{explanation} = &quot;Please create an account if you would like to explore other rooms.&quot;;

} elsif (!eval($$destination{criteria})) {

  $canEnter{explanation} = &quot;You cannot go into $$destination{title}.  I'm sorry.&quot;;

} elsif ($$VARS{lockedin} &gt; time) {

  my $remainingtime = ceil(($$VARS{lockedin} - time) / 60);
  $canEnter{explanation} = ''
      . &quot;You cannot change rooms for $remainingtime minutes.  &quot;
      . &quot;You can still send private messages, however, or talk to people in your current room.  &quot;
      ;
  $canEnter{warning} = 1;

} else {

  $canEnter{canEnter} = 1;

}

return \%canEnter;

</code>
  <type_nodetype>4</type_nodetype>
  <author_user>1449265</author_user>
  <package>0</package>
  <title>canEnterRoom</title>
</node>
