<node>
  <createtime>2009-03-27 10:45:32</createtime>
  <totalvotes>0</totalvotes>
  <node_id>1979757</node_id>
  <code>#Generates the form fields used to verify the form submission. Pass a prefix.
my ($prefix) = @_;
use Digest::MD5 qw(md5_hex);
my $rand = rand(999999999);
my $nonce;

if ($$USER{title} eq 'Guest User') {

  $nonce = md5_hex(htmlcode('getStarRatingSessionId') . ' ' . $rand);

} else {

  $nonce = md5_hex($$USER{passwd} . ' ' . $$USER{email} . $rand);

}

return $query-&gt;hidden($prefix . '_nonce', $nonce) . $query-&gt;hidden($prefix . '_seed', $rand);</code>
  <type_nodetype>4</type_nodetype>
  <author_user>974148</author_user>
  <title>verifyRequestForm</title>
</node>
