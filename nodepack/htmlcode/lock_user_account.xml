<node>
  <core>0</core>
  <reputation>0</reputation>
  <lockedby_user>0</lockedby_user>
  <createtime>2010-08-23 22:50:50</createtime>
  <locktime>0000-00-00 00:00:00</locktime>
  <totalvotes>0</totalvotes>
  <hits>0</hits>
  <node_id>1990145</node_id>
  <htmlcode_id>1990145</htmlcode_id>
  <checks_arguments>0</checks_arguments>
  <code>my ($uid) = @_;
getRef $uid;
return unless $uid;
return unless($$uid{type_nodetype} == getId(getType('user')));
$$uid{acctlock} = $$USER{user_id};

my $OP = getId(getNode(&quot;lockaccount&quot;,&quot;opcode&quot;));

$DB-&gt;sqlInsert('seclog',
  {
    'seclog_user' =&gt; $$USER{node_id}
    , 'seclog_node' =&gt; $OP
    , 'seclog_details' =&gt; &quot;$$uid{title}'s account was locked by $$USER{title}&quot;}
  );

# Delete all public messages from locked user
$DB-&gt;sqlDelete('message', &quot;for_user = 0 AND author_user = $$uid{user_id}&quot;);

# hide the locked user's scratch pad.
my $V = getVars($uid);
delete $$V{skratchShare};
setVars($uid, $V);
updateNode($uid, -1);
</code>
  <type_nodetype>4</type_nodetype>
  <author_user>1449265</author_user>
  <package>0</package>
  <title>lock user account</title>
</node>
