<node>
  <core>0</core>
  <reputation>0</reputation>
  <lockedby_user>0</lockedby_user>
  <createtime>2010-07-28 10:20:49</createtime>
  <locktime>0000-00-00 00:00:00</locktime>
  <totalvotes>0</totalvotes>
  <hits>0</hits>
  <node_id>1990059</node_id>
  <htmlcode_id>1990059</htmlcode_id>
  <checks_arguments>0</checks_arguments>
  <code># Generate a link to a stylesheet, incorporating the version 
# number of the node into the URL. This can be used in conjunction
# with a far-future expiry time to ensure that a stylesheet is
# cacheable, yet the most up to date version will always be
# requested when the node is updated. -- [call]
my ($n, $displaytype) = @_;
$displaytype ||= 'view' ;

unless (ref $n) {
	unless ($n =~ /\D/) {
	  $n = getNodeById($n);
	} else {
	  $n = getNode($n, 'stylesheet');
	}
}
if ($n) {
  my $v = $DB-&gt;{cache}-&gt;getGlobalVersion($n);

  return urlGen({
  	node_id =&gt; $n-&gt;{node_id},
  	version =&gt; $v,
  	displaytype =&gt; $displaytype
  }, 1)
	  if $$USER{node_id} == $$n{author_user};

  my $escapeTitle = CGI::escape($$n{title});
  my $autofixText = &quot;&quot;;
  $autofixText = &quot;_autofix&quot;
    if $$USER{ user_id } != $$n{ author_user }
    &amp;&amp; $$USER{ user_id } != $HTMLVARS{ guest_user };
  $escapeTitle =~ s/%[0-9A-F]{2}|_//g;
  my $stylesheetFilename = &quot;${escapeTitle}_v$v$autofixText.css&quot;; 
  return &quot;/stylesheet/$stylesheetFilename&quot;;
} else {
  return $n;
}
</code>
  <type_nodetype>4</type_nodetype>
  <author_user>5603</author_user>
  <package>0</package>
  <title>linkStylesheet</title>
</node>
