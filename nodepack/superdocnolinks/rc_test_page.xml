<node>
  <doctext>&lt;hr&gt;

[%

# getWriteup(title, username)
# returns node_id if exists else 0

local * getWriteup = sub {
	my $nid = getId(getNode($_[0], 'e2node'));
	if (!$nid) { return 0; }
	my $uid = getId(getNode($_[1], 'user'));
	if (!$uid) { return 0; }
	
	my $cursor = $DB-&gt;sqlSelectMany('writeup_id', 'writeup', &quot;parent_e2node = $nid&quot;);
	
	while (my ($wid) = $cursor-&gt;fetchrow()) {
		if (getNode($wid)-&gt;{author_user} == $uid) {
			return $wid;
		}
	}
	
	return 0;
};

return linkNode(getWriteup('foobarbaz', 'puppet'));

%]

&lt;hr&gt;

[%

my $str = '&lt;p&gt;';

my $uid = getNode('raincomplex', 'user')-&gt;{user_id};
$str .= 'uid: ' . $uid;

my ($writeup) =
   getNodeWhere(
      {
         &quot;-LIKE-title&quot; =&gt; $DB-&gt;quote('foobarbaz'),
         &quot;-author_user&quot; =&gt; $uid,
      },
      getType('writeup'));
$str .= '&lt;p&gt;writeup: ' . $writeup;

return $str;

%]</doctext>
  <createtime>2010-12-18 07:36:35</createtime>
  <totalvotes>0</totalvotes>
  <node_id>1990973</node_id>
  <edittime>0000-00-00 00:00:00</edittime>
  <type_nodetype>1065266</type_nodetype>
  <document_id>1990973</document_id>
  <author_user>1797883</author_user>
  <title>rc test page</title>
</node>
