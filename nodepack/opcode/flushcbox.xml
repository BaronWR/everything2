<node>
  <core>0</core>
  <reputation>0</reputation>
  <lockedby_user>0</lockedby_user>
  <createtime>2002-07-07 20:49:47</createtime>
  <locktime>0000-00-00 00:00:00</locktime>
  <totalvotes>0</totalvotes>
  <hits>1</hits>
  <node_id>1328318</node_id>
  <htmlcode_id>1328318</htmlcode_id>
  <checks_arguments>0</checks_arguments>
  <code>return unless isGod($USER) || (exists $HTMLVARS{'group_e2contact'}{$$USER{node_id}}) || (exists $HTMLVARS{'group_chanops'}{$$USER{node_id}});
my $currentRoomId = int($$USER{in_room});
my $currentRoom = getNode($currentRoomId);
my $currentRoomName;
if (!$currentRoom &amp;&amp; $currentRoomId) {
  $currentRoomName = &quot;in expired room (#$currentRoomId)&quot;;
} elsif (!$currentRoom) {
  $currentRoomName = &quot;outside&quot;;
} else {
  $currentRoomName = &quot;in room '$$currentRoom{title}'&quot;;
}
my $flushNode = getNode('flushcbox', 'opcode');
$DB-&gt;sqlInsert('seclog', {
   'seclog_node' =&gt; $$flushNode{node_id},
   'seclog_user' =&gt; $$USER{user_id},
   'seclog_details' =&gt; &quot;Chat $currentRoomName flushed.&quot;
});
$DB-&gt;sqlDelete(&quot;message&quot;, &quot;for_user = 0 AND room = $currentRoomId&quot;);
return 1;
</code>
  <type_nodetype>415056</type_nodetype>
  <author_user>459692</author_user>
  <package>0</package>
  <title>flushcbox</title>
</node>
