<node>
  <doctext>[%
return &quot;You're still quite young yet.  There is still much to be [Everything University|learned].&quot; unless(Everything::Experience::getLevel($USER) &gt; 1);

use Everything::Experience;

my $user_in = $query-&gt;param('speedyuser');
my $user_scratch = $user_in || $$USER{title};
my $str = htmlcode('openform').&quot;&lt;input type=\&quot;text\&quot; name=\&quot;speedyuser\&quot; value=\&quot;$user_scratch\&quot;&gt;&quot;.htmlcode('closeform').&quot;&lt;small&gt;&lt;p align=\&quot;right\&quot;&gt;(inspired by &quot;.linkNode(getNode('igloowhite', 'user')).&quot;'s homenode)&lt;/small&gt;&lt;/p&gt;&lt;br&gt;&lt;br&gt;&quot;;

  return $str.=&quot;Okay, the radar gun's ready.  Who should we clock?&quot; unless($user_in);

  my $u = getNode($user_in, 'user');
  return $str.=&quot;&lt;br&gt;&lt;br&gt;Your aim is way off. $user_in isn't a user. Try again.&quot; unless($u);

  my $initcnt = $DB-&gt;sqlSelect(&quot;count(*)&quot;, &quot;node&quot;, &quot;author_user=$$u{user_id} AND type_nodetype=&quot;.getId(getType('writeup')));

  return $str.=&quot;&lt;br&gt;&lt;br&gt;Um, user $$u{title} has no writeups!&quot; if ($initcnt == 0);

  $str.= &quot;$$u{title} has &quot;.$initcnt.&quot; nodes. &quot;;
  my $cnt;
  if($initcnt &gt; 49){$cnt = 50;}else{$str .=&quot;Since it's less than fifty, we'll go on that data.&lt;br&gt;&quot;; $cnt = $initcnt};


  my $lastcnt = $DB-&gt;sqlSelect(&quot;TO_DAYS(NOW())-TO_DAYS(publishtime)&quot;,
  	&quot;node JOIN writeup ON writeup_id=node_id&quot;, &quot;author_user=$$u{node_id} ORDER BY publishtime DESC limit $cnt,1&quot;);

if ($lastcnt &lt; 1) {
  $str.=&quot;&lt;br&gt;&lt;br&gt;Wait a while, &quot;;
  return $str.&quot;do at least one [day|lap] around the track before timing yourself.&quot; if($$USER{node_id} == $$u{node_id});
  return $str.&quot;let [&quot;.$$u{title}.&quot;] do at least one [day|lap] around the track before timing them.&quot;;
}

  $str .= &quot;&lt;br&gt;&lt;b&gt;Noding Speed&lt;/b&gt;:&lt;br&gt;  To write $cnt nodes, it took the user $lastcnt days.   This is approximately &lt;b&gt;&quot;.sprintf(&quot;%.4f&quot;, $cnt/$lastcnt).&quot;&lt;/b&gt; nodes per day.&lt;br&gt;&lt;br&gt;&quot;;

  my $lvwu = getVars(getNode(&quot;level writeups&quot;, &quot;setting&quot;));
  my $curlvl = Everything::Experience::getLevel($u);
  
  # Gz moved the code for getting the Honor Roll level-up factor
  # because the code broke for users whose levelup factor
  # pushed them over the limit 

  my $hrlf = getHRLF($u); #Gz
  my $levelupwu = $$lvwu{$curlvl + 1} * $hrlf; #Gz

  return $str.&quot;&lt;br&gt;&lt;br&gt;&lt;small&gt;($$u{title} is held back by experience and not writeups)&lt;/small&gt;&quot; if($levelupwu &lt;= $initcnt); #Gz

  # (notGz)I moved this line up because it doesn't depend on
  # prediction calculation so it will be faster here.

 # -- commented out - Gz
 #  return $str.&quot;&lt;br&gt;&lt;br&gt;&lt;small&gt;($$u{title} is held back by experience and not 
 # writeups)&lt;/small&gt;&quot; if($$lvwu{$curlvl + 1} &lt;= $initcnt);

  # Honor roll code.
  # Get level-up factor and find number of required WU's.
  # (notGz)I'm assuming getHRLF returns 1.0 for people not on
  # the Honor Roll.

  # getHRLF was called here -- Gz. Now use LEVELUPWU  
  my $reqd = $levelupwu - $initcnt + 1; #Gz
  my $predict = $reqd /($cnt/$lastcnt);

  my $csr = $dbh-&gt;prepare(&quot;SELECT NOW() + INTERVAL $predict DAY as pd&quot;);
  $csr-&gt;execute();
  my $predictdate = $csr-&gt;fetchrow_hashref();

  # Display different results, depending on whether the
  # user is on the Honor Roll or not.
  # Also, changed the print-out to use $reqd, rather than
  # recalculating the expression as it was before.

  return $str .= &quot;&lt;br&gt;&lt;b&gt;Level Predictions&lt;/b&gt;&lt;br&gt; Since $$u{title} is currently level $curlvl and not on the [Honor Roll], the user will reach lv &quot;.($curlvl + 1).&quot; (&quot;.int($reqd).&quot; more writeups) in &quot;.int($predict).&quot; days. (on $$predictdate{pd})&quot; unless($hrlf &lt; 1.0 || $curlvl == 13);

  $str .= &quot;&lt;br&gt;&lt;b&gt;Level Predictions&lt;/b&gt;&lt;br&gt; Since $$u{title} is currently level $curlvl and has a LF of &quot; . sprintf('%.4f',$hrlf) . &quot;, the user will reach lv &quot;.($curlvl + 1).&quot; (&quot;.int($reqd).&quot; more writeups) in &quot;.int($predict).&quot; days. (on $$predictdate{pd})&quot; unless($curlvl == 13);

  return $str;
%]</doctext>
  <createtime>2007-11-01 18:12:00</createtime>
  <totalvotes>0</totalvotes>
  <node_id>1915064</node_id>
  <edittime>0000-00-00 00:00:00</edittime>
  <type_nodetype>14</type_nodetype>
  <title>Gz Noding Speedometer test</title>
</node>
